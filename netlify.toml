[build]
  publish = "dist"
  command = "npm run build"
  functions = "netlify/functions"

[build.environment]
  NODE_VERSION = "20"

[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/:splat"
  status = 200

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200

# Scheduled function for daily data archiving
[[plugins]]
  package = "@netlify/plugin-scheduled-functions"

  [plugins.inputs]
  [plugins.inputs.scheduled-archive]
    schedule = "0 7 * * *"  # 3am ET (7am UTC)

# Environment variables needed:
# MONGODB_URI - MongoDB connection string
# MONGODB_DB_NAME - Database name (default: bi-forecast)
# JWT_SECRET - Secret key for JWT tokens
# ENCRYPTION_KEY - Secret key for encrypting OAuth tokens
# GOOGLE_CLIENT_ID - Google OAuth client ID
# QBO_CLIENT_ID - QuickBooks OAuth client ID
# QBO_CLIENT_SECRET - QuickBooks OAuth client secret
# QBO_REDIRECT_URI - QuickBooks OAuth redirect URI